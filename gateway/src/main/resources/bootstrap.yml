server:
  address: 192.168.31.103

spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          jwk-set-uri: 'http://${server.address}:8013/getPublicKey'
  application:
    name: cim-getway
  cloud:
    consul:
      host: localhost  #consul的IP（可以改成自己电脑ip）
      port: 8500       #consul启动端口默认8500
      discovery:
        service-name: ${spring.application.name}
        prefer-ip-address: true     #不写这个配置，在docker下的consul里面健康检查会失败
        healthCheckInterval: 5s     #健康检查频率
        port: ${server.port}        #注册服务所在端口
    gateway:
      discovery:
        locator:
          enabled: true # 启用服务发现
          lower-case-service-id: true
      routes:
        - id: author
          uri: lb://cim-authorization
          predicates:
            - Path=/api-v1/oauth/token
          filters:
            - StripPrefix=1
        - id: file
          uri: lb://cim-file-server
          predicates:
            - Path=/api-v1/artifact/**
          filters:
            - StripPrefix=2

        - id: api
          uri: lb://cim-api
          predicates:
            - Path=/api-v1/**
          filters:
            - StripPrefix=1

        - id: socket
          uri: lb://cim-socket
          predicates:
            - Path=/socket.io/**,
          filters:
            - StripPrefix=0

white-list:
  urls:
    - "/api-v1/oauth/token"
    - "/actuator/health"
    - "/socket.io"
    - "/api-v1/artifact/**"
